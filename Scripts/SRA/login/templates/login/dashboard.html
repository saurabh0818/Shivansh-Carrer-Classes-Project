{% extends "login/main.html" %}
{% block link%}
<style>
  #chartdiv {
    width: 100%;
    height: 350px;
  }
</style>
{% endblock %}
{% block active_home %} active {% endblock %}

{% block body %}
{% load static %}
<div class="container-fluid">

  <!-- Page Heading -->
  <div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800">Dashboard - {{crn_years}}</h1>

  </div>

  <!-- Content Row -->
  <div class="row">

    <!-- Earnings (Monthly) Card Example -->
    <div class="col-xl-3 col-md-6 mb-4">
      <div class="card border-left-primary shadow h-100 py-2">
        <div class="card-body">
          <div class="row no-gutters align-items-center">
            <div class="col mr-2">
              <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">Fees
                Recieved( Year - {{crn_years}} )
              </div>
              <div class="h5 mb-0 font-weight-bold text-gray-800">₹ {{total_amount}}</div>
            </div>
            <div class="col-auto">
              <i class="fas fa-calendar fa-2x text-primary"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Earnings (Monthly) Card Example -->
    <div class="col-xl-3 col-md-6 mb-4">
      <div class="card border-left-success shadow h-100 py-2">
        <div class="card-body">
          <div class="row no-gutters align-items-center">
            <div class="col mr-2">
              <div class="text-xs font-weight-bold text-success text-uppercase mb-1">Fees Due(
                Year - {{crn_years}} )
              </div>
              <div class="h5 mb-0 font-weight-bold text-gray-800">₹ {{Due_Amount}}</div>
            </div>
            <div class="col-auto">
              <i class="fas fa-rupee-sign fa-2x text-success"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Earnings (Monthly) Card Example -->
    <div class="col-xl-3 col-md-6 mb-4">
      <div class="card border-left-info shadow h-100 py-2">
        <div class="card-body">
          <div class="row no-gutters align-items-center">
            <div class="col mr-2">
              <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Total Expenditure</div>
              <div class="row no-gutters align-items-center">
                <div class="col-auto">
                  <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">₹ {{currnt}}
                  </div>
                </div>

              </div>
            </div>
            <div class="col-auto">
              <i class="fas fa-clipboard-list fa-2x text-info"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Pending Requests Card Example -->
    <div class="col-xl-3 col-md-6 mb-4">
      <div class="card border-left-warning shadow h-100 py-2">
        <div class="card-body">
          <div class="row no-gutters align-items-center">
            <div class="col mr-2">
              <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">TOTAL TEACHERS
              </div>
              <div class="h5 mb-0 font-weight-bold text-gray-800"><i class="fas fa-user-friends"></i>
                {{totl_teacher}}</div>
            </div>
            <div class="col-auto">
              <i class="fas fa-chalkboard-teacher fa-2x text-warning"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="container-fluid">

  {% if mon %}
  <div class="row my-2">
    <div class="col-md-12">

      <div class="card shadow mb-4">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">Income Year - {{crn_years}}</h6>
        </div>
        <div class="card-body">
          <div id="chartdiv3" style="height: 370px; width: 100%;"></div>
        </div>
      </div>

    </div>
  </div>
  {% endif %}

  <div class="row ">

    {% if not mon and not data_dic_tech and not data_dic_expend %}
    <div class="col-md-12 my-3">
      <div class="card shadow mb-4">
        <div class="card-header py-3">
          <h3 class="m-0 font-weight-bold text-primary">Welcome {{user.username|capfirst}} , Track Your All
            {{crn_years}} Records With Us</h3>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-4">
              <div class="text-center">
                <img class="img-fluid px-3 px-sm-4 mt-3 mb-4" style="width: 25rem;" src="{% static 'svg/dash1.png' %}"
                  alt="">
              </div>
              <div class="text-center">
                <h5>Monitor Task with Graphs</h5>
              </div>
            </div>

            <div class="col-md-4">
              <div class="text-center">
                <img class="img-fluid px-3 px-sm-4 mt-3 mb-4" style="width: 25rem;" src="{% static 'svg/task.png' %}"
                  alt="">
              </div>
              <div class="text-center">
                <h5>Manage Data in One Software</h5>
              </div>
            </div>

            <div class="col-md-4">
              <div class="text-center">
                <img class="img-fluid px-3 px-sm-4 mt-3 mb-4" style="width: 25rem;" src="{% static 'svg/reports.png' %}"
                  alt="">
              </div>
              <div class="text-center">
                <h5>Share Data Using Reports</h5>
              </div>
            </div>
          </div>
          <br><br>

          <hr>
          <p class="mb-0">Developed by Techshra Software Private limted.</p>
        </div>
      </div>
    </div>

    {% endif %}


    {% if data_dic_expend %}
    <div class="col-md-6 ">

      <div class="card shadow mb-4 mb-5">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">Expenditure</h6>
        </div>
        <div class="card-body">
          <div id="chartdiv1" style="height: 350px; width: 100%;"></div>
        </div>
      </div>

    </div>

    {% endif %}

    {% if data_dic_tech %}
    <div class="col-md-6 ">

      <div class="card shadow mb-4">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">Teacher Payment</h6>
        </div>
        <div class="card-body">
          <!--<div id="chartContainer2" style="height: 350px; width: 100%;"></div>-->
          <div id="chartdiv" style="height: 350px; width: 100%;"></div>

        </div>
      </div>

    </div>
    {% endif %}


  </div>



</div>





{% endblock %}

{% block js %}
<script>


  window.onload = function () {


    am4core.ready(function () {

      // Themes begin
      am4core.useTheme(am4themes_kelly);
      am4core.useTheme(am4themes_animated);


      function areachart() {

        // Themes end country visits

        // Create chart instance
        var chart2 = am4core.create("chartdiv3", am4charts.XYChart3D);

        // Add data
        chart2.data = [
          {% for x in mon %}
      {% for p, q in x.items %}
      {
        "month": "{{p}}",
          "amount": {{q}}
      },
      {% endfor %}
      {% endfor %}
  

];


      // Create axes
      let categoryAxis = chart2.xAxes.push(new am4charts.CategoryAxis());
      categoryAxis.dataFields.category = "month";
      categoryAxis.renderer.labels.template.rotation = 270;
      categoryAxis.renderer.labels.template.hideOversized = false;
      categoryAxis.renderer.minGridDistance = 20;
      categoryAxis.renderer.labels.template.horizontalCenter = "right";
      categoryAxis.renderer.labels.template.verticalCenter = "middle";
      categoryAxis.tooltip.label.rotation = 270;
      categoryAxis.tooltip.label.horizontalCenter = "right";
      categoryAxis.tooltip.label.verticalCenter = "middle";

      let valueAxis = chart2.yAxes.push(new am4charts.ValueAxis());
      valueAxis.title.text = "Incomes";
      valueAxis.title.fontWeight = "bold";

      // Create series
      var series = chart2.series.push(new am4charts.ColumnSeries3D());
      series.dataFields.valueY = "amount";
      series.dataFields.categoryX = "month";
      series.name = "amount";
      series.tooltipText = "{categoryX}: [bold]{valueY}[/]";
      series.columns.template.fillOpacity = .8;

      var columnTemplate = series.columns.template;
      columnTemplate.strokeWidth = 2;
      columnTemplate.strokeOpacity = 1;
      columnTemplate.stroke = am4core.color("#FFFFFF");

      columnTemplate.adapter.add("fill", function (fill, target) {
        return chart2.colors.getIndex(target.dataItem.index);
      })

      columnTemplate.adapter.add("stroke", function (stroke, target) {
        return chart2.colors.getIndex(target.dataItem.index);
      })

      chart2.cursor = new am4charts.XYCursor();
      chart2.cursor.lineX.strokeOpacity = 0;
      chart2.cursor.lineY.strokeOpacity = 0;



    }

// Themes end
function tech() {
        var chart = am4core.create("chartdiv", am4charts.PieChart3D);
        chart.hiddenState.properties.opacity = 0; // this creates initial fade-in

        chart.legend = new am4charts.Legend();

        chart.data = [
          {% for key, amt in data_dic_tech.items %}
	{
        "month": "{{key}}",
        "Amount": {{amt}}
				
	},
  {% endfor %}
	];

  var series = chart.series.push(new am4charts.PieSeries3D());
  series.dataFields.value = "Amount";
  series.dataFields.category = "month";
}

  function expends() {
    var chart1 = am4core.create("chartdiv1", am4charts.PieChart3D);
    chart1.hiddenState.properties.opacity = 0; // this creates initial fade-in

    chart1.legend = new am4charts.Legend();

    chart1.data = [
      {% for ky, amnt in data_dic_expend.items %}
  {
    "month": "{{ky}}",
      "Amount": {{amnt}}

  },
  {% endfor %}
	];

  var series1 = chart1.series.push(new am4charts.PieSeries3D());
  series1.dataFields.value = "Amount";
  series1.dataFields.category = "month";
}

  {% if data_dic_tech %}
  tech()
  {% endif %}
  {% if data_dic_expend %}
  expends()
  {% endif %}
  {%if mon %}
  areachart()
  {% endif %}
}); // end am4core.ready()

}




</script>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
<script src="https://cdn.amcharts.com/lib/4/core.js"></script>
<script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
<script src="https://cdn.amcharts.com/lib/4/themes/kelly.js"></script>
<script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>
{% endblock %}